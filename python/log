if close >=  ep + 11 * levelDiff then begin 
    buytocover ("Exit short at L11 from UpOutRegion") posPerLevel contract total next bar at ep+11*levelDiff limit;
    buytocover ("Exit short at L10 from UpOutRegion") posPerLevel contract total next bar at ep+10*levelDiff limit;
    buytocover ("Exit short at L9 from UpOutRegion") posPerLevel contract total next bar at ep+9*levelDiff limit;
    buytocover ("Exit short at L8 from UpOutRegion") posPerLevel contract total next bar at ep+8*levelDiff limit;
    buytocover ("Exit short at L7 from UpOutRegion") posPerLevel contract total next bar at ep+7*levelDiff limit;
    buytocover ("Exit short at L6 from UpOutRegion") posPerLevel contract total next bar at ep+6*levelDiff limit;
    buytocover ("Exit short at L5 from UpOutRegion") posPerLevel contract total next bar at ep+5*levelDiff limit;
    buytocover ("Exit short at L4 from UpOutRegion") posPerLevel contract total next bar at ep+4*levelDiff limit;
    buytocover ("Exit short at L3 from UpOutRegion") posPerLevel contract total next bar at ep+3*levelDiff limit;
    buytocover ("Exit short at L2 from UpOutRegion") posPerLevel contract total next bar at ep+2*levelDiff limit;
    buytocover ("Exit short at L1 from UpOutRegion") posPerLevel contract total next bar at ep+1*levelDiff limit;
    buytocover ("Exit short at EP from UpOutRegion") posPerLevel contract total next bar at ep limit;
    buy ("Long at L-1 from UpOutRegion") posPerLevel contract next bar at ep-1*levelDiff limit;
    buy ("Long at L-2 from UpOutRegion") posPerLevel contract next bar at ep-2*levelDiff limit;
    buy ("Long at L-3 from UpOutRegion") posPerLevel contract next bar at ep-3*levelDiff limit;
    buy ("Long at L-4 from UpOutRegion") posPerLevel contract next bar at ep-4*levelDiff limit;
    buy ("Long at L-5 from UpOutRegion") posPerLevel contract next bar at ep-5*levelDiff limit;
    buy ("Long at L-6 from UpOutRegion") posPerLevel contract next bar at ep-6*levelDiff limit;
    buy ("Long at L-7 from UpOutRegion") posPerLevel contract next bar at ep-7*levelDiff limit;
    buy ("Long at L-8 from UpOutRegion") posPerLevel contract next bar at ep-8*levelDiff limit;
    buy ("Long at L-9 from UpOutRegion") posPerLevel contract next bar at ep-9*levelDiff limit;
    buy ("Long at L-10 from UpOutRegion") posPerLevel contract next bar at ep-10*levelDiff limit;
    buy ("Long at L-11 from UpOutRegion") posPerLevel contract next bar at ep-11*levelDiff limit;
end;
if close>=ep+10*levelDiff and close<ep+11*levelDiff then begin 
    if currentcontracts=10 or isDayOpen then begin
        sellshort("Short at L11 from L10L11") posPerLevel contracts next bar at ep+11*levelDiff limit; 
    end;
    if currentcontracts=11 then 
        buytocover ("Exit short at L10 from L10L11") posPerLevel contract total next bar at ep+10*levelDiff limit;
    end;
    buytocover ("Exit short at L9 from L10L11") posPerLevel contract total next bar at ep+9*levelDiff limit;
    buytocover ("Exit short at L8 from L10L11") posPerLevel contract total next bar at ep+8*levelDiff limit;
    buytocover ("Exit short at L7 from L10L11") posPerLevel contract total next bar at ep+7*levelDiff limit;
    buytocover ("Exit short at L6 from L10L11") posPerLevel contract total next bar at ep+6*levelDiff limit;
    buytocover ("Exit short at L5 from L10L11") posPerLevel contract total next bar at ep+5*levelDiff limit;
    buytocover ("Exit short at L4 from L10L11") posPerLevel contract total next bar at ep+4*levelDiff limit;
    buytocover ("Exit short at L3 from L10L11") posPerLevel contract total next bar at ep+3*levelDiff limit;
    buytocover ("Exit short at L2 from L10L11") posPerLevel contract total next bar at ep+2*levelDiff limit;
    buytocover ("Exit short at L1 from L10L11") posPerLevel contract total next bar at ep+1*levelDiff limit;
    buytocover ("Exit short at EP from L10L11") posPerLevel contract total next bar at ep limit;
    buy ("Long at L-1 from L10L11") posPerLevel contract next bar at ep-1*levelDiff limit;
    buy ("Long at L-2 from L10L11") posPerLevel contract next bar at ep-2*levelDiff limit;
    buy ("Long at L-3 from L10L11") posPerLevel contract next bar at ep-3*levelDiff limit;
    buy ("Long at L-4 from L10L11") posPerLevel contract next bar at ep-4*levelDiff limit;
    buy ("Long at L-5 from L10L11") posPerLevel contract next bar at ep-5*levelDiff limit;
    buy ("Long at L-6 from L10L11") posPerLevel contract next bar at ep-6*levelDiff limit;
    buy ("Long at L-7 from L10L11") posPerLevel contract next bar at ep-7*levelDiff limit;
    buy ("Long at L-8 from L10L11") posPerLevel contract next bar at ep-8*levelDiff limit;
    buy ("Long at L-9 from L10L11") posPerLevel contract next bar at ep-9*levelDiff limit;
    buy ("Long at L-10 from L10L11") posPerLevel contract next bar at ep-10*levelDiff limit;
    buy ("Long at L-11 from L10L11") posPerLevel contract next bar at ep-11*levelDiff limit;
end;
if close>=ep+9*levelDiff and close<ep+10*levelDiff then begin 
    sellshort ("Short at L11 from L9L10") posPerLevel contracts next bar at ep+11*levelDiff limit;
    if currentcontracts=9 or isDayOpen then begin
        sellshort("Short at L10 from L9L10") posPerLevel contracts next bar at ep+10*levelDiff limit; 
    end;
    if currentcontracts=10 then 
        buytocover ("Exit short at L9 from L9L10") posPerLevel contract total next bar at ep+9*levelDiff limit;
    end;
    buytocover ("Exit short at L8 from L9L10") posPerLevel contract total next bar at ep+8*levelDiff limit;
    buytocover ("Exit short at L7 from L9L10") posPerLevel contract total next bar at ep+7*levelDiff limit;
    buytocover ("Exit short at L6 from L9L10") posPerLevel contract total next bar at ep+6*levelDiff limit;
    buytocover ("Exit short at L5 from L9L10") posPerLevel contract total next bar at ep+5*levelDiff limit;
    buytocover ("Exit short at L4 from L9L10") posPerLevel contract total next bar at ep+4*levelDiff limit;
    buytocover ("Exit short at L3 from L9L10") posPerLevel contract total next bar at ep+3*levelDiff limit;
    buytocover ("Exit short at L2 from L9L10") posPerLevel contract total next bar at ep+2*levelDiff limit;
    buytocover ("Exit short at L1 from L9L10") posPerLevel contract total next bar at ep+1*levelDiff limit;
    buytocover ("Exit short at EP from L9L10") posPerLevel contract total next bar at ep limit;
    buy ("Long at L-1 from L9L10") posPerLevel contract next bar at ep-1*levelDiff limit;
    buy ("Long at L-2 from L9L10") posPerLevel contract next bar at ep-2*levelDiff limit;
    buy ("Long at L-3 from L9L10") posPerLevel contract next bar at ep-3*levelDiff limit;
    buy ("Long at L-4 from L9L10") posPerLevel contract next bar at ep-4*levelDiff limit;
    buy ("Long at L-5 from L9L10") posPerLevel contract next bar at ep-5*levelDiff limit;
    buy ("Long at L-6 from L9L10") posPerLevel contract next bar at ep-6*levelDiff limit;
    buy ("Long at L-7 from L9L10") posPerLevel contract next bar at ep-7*levelDiff limit;
    buy ("Long at L-8 from L9L10") posPerLevel contract next bar at ep-8*levelDiff limit;
    buy ("Long at L-9 from L9L10") posPerLevel contract next bar at ep-9*levelDiff limit;
    buy ("Long at L-10 from L9L10") posPerLevel contract next bar at ep-10*levelDiff limit;
    buy ("Long at L-11 from L9L10") posPerLevel contract next bar at ep-11*levelDiff limit;
end;
if close>=ep+8*levelDiff and close<ep+9*levelDiff then begin 
    sellshort ("Short at L11 from L8L9") posPerLevel contracts next bar at ep+11*levelDiff limit;
    sellshort ("Short at L10 from L8L9") posPerLevel contracts next bar at ep+10*levelDiff limit;
    if currentcontracts=8 or isDayOpen then begin
        sellshort("Short at L9 from L8L9") posPerLevel contracts next bar at ep+9*levelDiff limit; 
    end;
    if currentcontracts=9 then 
        buytocover ("Exit short at L8 from L8L9") posPerLevel contract total next bar at ep+8*levelDiff limit;
    end;
    buytocover ("Exit short at L7 from L8L9") posPerLevel contract total next bar at ep+7*levelDiff limit;
    buytocover ("Exit short at L6 from L8L9") posPerLevel contract total next bar at ep+6*levelDiff limit;
    buytocover ("Exit short at L5 from L8L9") posPerLevel contract total next bar at ep+5*levelDiff limit;
    buytocover ("Exit short at L4 from L8L9") posPerLevel contract total next bar at ep+4*levelDiff limit;
    buytocover ("Exit short at L3 from L8L9") posPerLevel contract total next bar at ep+3*levelDiff limit;
    buytocover ("Exit short at L2 from L8L9") posPerLevel contract total next bar at ep+2*levelDiff limit;
    buytocover ("Exit short at L1 from L8L9") posPerLevel contract total next bar at ep+1*levelDiff limit;
    buytocover ("Exit short at EP from L8L9") posPerLevel contract total next bar at ep limit;
    buy ("Long at L-1 from L8L9") posPerLevel contract next bar at ep-1*levelDiff limit;
    buy ("Long at L-2 from L8L9") posPerLevel contract next bar at ep-2*levelDiff limit;
    buy ("Long at L-3 from L8L9") posPerLevel contract next bar at ep-3*levelDiff limit;
    buy ("Long at L-4 from L8L9") posPerLevel contract next bar at ep-4*levelDiff limit;
    buy ("Long at L-5 from L8L9") posPerLevel contract next bar at ep-5*levelDiff limit;
    buy ("Long at L-6 from L8L9") posPerLevel contract next bar at ep-6*levelDiff limit;
    buy ("Long at L-7 from L8L9") posPerLevel contract next bar at ep-7*levelDiff limit;
    buy ("Long at L-8 from L8L9") posPerLevel contract next bar at ep-8*levelDiff limit;
    buy ("Long at L-9 from L8L9") posPerLevel contract next bar at ep-9*levelDiff limit;
    buy ("Long at L-10 from L8L9") posPerLevel contract next bar at ep-10*levelDiff limit;
    buy ("Long at L-11 from L8L9") posPerLevel contract next bar at ep-11*levelDiff limit;
end;
if close>=ep+7*levelDiff and close<ep+8*levelDiff then begin 
    sellshort ("Short at L11 from L7L8") posPerLevel contracts next bar at ep+11*levelDiff limit;
    sellshort ("Short at L10 from L7L8") posPerLevel contracts next bar at ep+10*levelDiff limit;
    sellshort ("Short at L9 from L7L8") posPerLevel contracts next bar at ep+9*levelDiff limit;
    if currentcontracts=7 or isDayOpen then begin
        sellshort("Short at L8 from L7L8") posPerLevel contracts next bar at ep+8*levelDiff limit; 
    end;
    if currentcontracts=8 then 
        buytocover ("Exit short at L7 from L7L8") posPerLevel contract total next bar at ep+7*levelDiff limit;
    end;
    buytocover ("Exit short at L6 from L7L8") posPerLevel contract total next bar at ep+6*levelDiff limit;
    buytocover ("Exit short at L5 from L7L8") posPerLevel contract total next bar at ep+5*levelDiff limit;
    buytocover ("Exit short at L4 from L7L8") posPerLevel contract total next bar at ep+4*levelDiff limit;
    buytocover ("Exit short at L3 from L7L8") posPerLevel contract total next bar at ep+3*levelDiff limit;
    buytocover ("Exit short at L2 from L7L8") posPerLevel contract total next bar at ep+2*levelDiff limit;
    buytocover ("Exit short at L1 from L7L8") posPerLevel contract total next bar at ep+1*levelDiff limit;
    buytocover ("Exit short at EP from L7L8") posPerLevel contract total next bar at ep limit;
    buy ("Long at L-1 from L7L8") posPerLevel contract next bar at ep-1*levelDiff limit;
    buy ("Long at L-2 from L7L8") posPerLevel contract next bar at ep-2*levelDiff limit;
    buy ("Long at L-3 from L7L8") posPerLevel contract next bar at ep-3*levelDiff limit;
    buy ("Long at L-4 from L7L8") posPerLevel contract next bar at ep-4*levelDiff limit;
    buy ("Long at L-5 from L7L8") posPerLevel contract next bar at ep-5*levelDiff limit;
    buy ("Long at L-6 from L7L8") posPerLevel contract next bar at ep-6*levelDiff limit;
    buy ("Long at L-7 from L7L8") posPerLevel contract next bar at ep-7*levelDiff limit;
    buy ("Long at L-8 from L7L8") posPerLevel contract next bar at ep-8*levelDiff limit;
    buy ("Long at L-9 from L7L8") posPerLevel contract next bar at ep-9*levelDiff limit;
    buy ("Long at L-10 from L7L8") posPerLevel contract next bar at ep-10*levelDiff limit;
    buy ("Long at L-11 from L7L8") posPerLevel contract next bar at ep-11*levelDiff limit;
end;
if close>=ep+6*levelDiff and close<ep+7*levelDiff then begin 
    sellshort ("Short at L11 from L6L7") posPerLevel contracts next bar at ep+11*levelDiff limit;
    sellshort ("Short at L10 from L6L7") posPerLevel contracts next bar at ep+10*levelDiff limit;
    sellshort ("Short at L9 from L6L7") posPerLevel contracts next bar at ep+9*levelDiff limit;
    sellshort ("Short at L8 from L6L7") posPerLevel contracts next bar at ep+8*levelDiff limit;
    if currentcontracts=6 or isDayOpen then begin
        sellshort("Short at L7 from L6L7") posPerLevel contracts next bar at ep+7*levelDiff limit; 
    end;
    if currentcontracts=7 then 
        buytocover ("Exit short at L6 from L6L7") posPerLevel contract total next bar at ep+6*levelDiff limit;
    end;
    buytocover ("Exit short at L5 from L6L7") posPerLevel contract total next bar at ep+5*levelDiff limit;
    buytocover ("Exit short at L4 from L6L7") posPerLevel contract total next bar at ep+4*levelDiff limit;
    buytocover ("Exit short at L3 from L6L7") posPerLevel contract total next bar at ep+3*levelDiff limit;
    buytocover ("Exit short at L2 from L6L7") posPerLevel contract total next bar at ep+2*levelDiff limit;
    buytocover ("Exit short at L1 from L6L7") posPerLevel contract total next bar at ep+1*levelDiff limit;
    buytocover ("Exit short at EP from L6L7") posPerLevel contract total next bar at ep limit;
    buy ("Long at L-1 from L6L7") posPerLevel contract next bar at ep-1*levelDiff limit;
    buy ("Long at L-2 from L6L7") posPerLevel contract next bar at ep-2*levelDiff limit;
    buy ("Long at L-3 from L6L7") posPerLevel contract next bar at ep-3*levelDiff limit;
    buy ("Long at L-4 from L6L7") posPerLevel contract next bar at ep-4*levelDiff limit;
    buy ("Long at L-5 from L6L7") posPerLevel contract next bar at ep-5*levelDiff limit;
    buy ("Long at L-6 from L6L7") posPerLevel contract next bar at ep-6*levelDiff limit;
    buy ("Long at L-7 from L6L7") posPerLevel contract next bar at ep-7*levelDiff limit;
    buy ("Long at L-8 from L6L7") posPerLevel contract next bar at ep-8*levelDiff limit;
    buy ("Long at L-9 from L6L7") posPerLevel contract next bar at ep-9*levelDiff limit;
    buy ("Long at L-10 from L6L7") posPerLevel contract next bar at ep-10*levelDiff limit;
    buy ("Long at L-11 from L6L7") posPerLevel contract next bar at ep-11*levelDiff limit;
end;
if close>=ep+5*levelDiff and close<ep+6*levelDiff then begin 
    sellshort ("Short at L11 from L5L6") posPerLevel contracts next bar at ep+11*levelDiff limit;
    sellshort ("Short at L10 from L5L6") posPerLevel contracts next bar at ep+10*levelDiff limit;
    sellshort ("Short at L9 from L5L6") posPerLevel contracts next bar at ep+9*levelDiff limit;
    sellshort ("Short at L8 from L5L6") posPerLevel contracts next bar at ep+8*levelDiff limit;
    sellshort ("Short at L7 from L5L6") posPerLevel contracts next bar at ep+7*levelDiff limit;
    if currentcontracts=5 or isDayOpen then begin
        sellshort("Short at L6 from L5L6") posPerLevel contracts next bar at ep+6*levelDiff limit; 
    end;
    if currentcontracts=6 then 
        buytocover ("Exit short at L5 from L5L6") posPerLevel contract total next bar at ep+5*levelDiff limit;
    end;
    buytocover ("Exit short at L4 from L5L6") posPerLevel contract total next bar at ep+4*levelDiff limit;
    buytocover ("Exit short at L3 from L5L6") posPerLevel contract total next bar at ep+3*levelDiff limit;
    buytocover ("Exit short at L2 from L5L6") posPerLevel contract total next bar at ep+2*levelDiff limit;
    buytocover ("Exit short at L1 from L5L6") posPerLevel contract total next bar at ep+1*levelDiff limit;
    buytocover ("Exit short at EP from L5L6") posPerLevel contract total next bar at ep limit;
    buy ("Long at L-1 from L5L6") posPerLevel contract next bar at ep-1*levelDiff limit;
    buy ("Long at L-2 from L5L6") posPerLevel contract next bar at ep-2*levelDiff limit;
    buy ("Long at L-3 from L5L6") posPerLevel contract next bar at ep-3*levelDiff limit;
    buy ("Long at L-4 from L5L6") posPerLevel contract next bar at ep-4*levelDiff limit;
    buy ("Long at L-5 from L5L6") posPerLevel contract next bar at ep-5*levelDiff limit;
    buy ("Long at L-6 from L5L6") posPerLevel contract next bar at ep-6*levelDiff limit;
    buy ("Long at L-7 from L5L6") posPerLevel contract next bar at ep-7*levelDiff limit;
    buy ("Long at L-8 from L5L6") posPerLevel contract next bar at ep-8*levelDiff limit;
    buy ("Long at L-9 from L5L6") posPerLevel contract next bar at ep-9*levelDiff limit;
    buy ("Long at L-10 from L5L6") posPerLevel contract next bar at ep-10*levelDiff limit;
    buy ("Long at L-11 from L5L6") posPerLevel contract next bar at ep-11*levelDiff limit;
end;
if close>=ep+4*levelDiff and close<ep+5*levelDiff then begin 
    sellshort ("Short at L11 from L4L5") posPerLevel contracts next bar at ep+11*levelDiff limit;
    sellshort ("Short at L10 from L4L5") posPerLevel contracts next bar at ep+10*levelDiff limit;
    sellshort ("Short at L9 from L4L5") posPerLevel contracts next bar at ep+9*levelDiff limit;
    sellshort ("Short at L8 from L4L5") posPerLevel contracts next bar at ep+8*levelDiff limit;
    sellshort ("Short at L7 from L4L5") posPerLevel contracts next bar at ep+7*levelDiff limit;
    sellshort ("Short at L6 from L4L5") posPerLevel contracts next bar at ep+6*levelDiff limit;
    if currentcontracts=4 or isDayOpen then begin
        sellshort("Short at L5 from L4L5") posPerLevel contracts next bar at ep+5*levelDiff limit; 
    end;
    if currentcontracts=5 then 
        buytocover ("Exit short at L4 from L4L5") posPerLevel contract total next bar at ep+4*levelDiff limit;
    end;
    buytocover ("Exit short at L3 from L4L5") posPerLevel contract total next bar at ep+3*levelDiff limit;
    buytocover ("Exit short at L2 from L4L5") posPerLevel contract total next bar at ep+2*levelDiff limit;
    buytocover ("Exit short at L1 from L4L5") posPerLevel contract total next bar at ep+1*levelDiff limit;
    buytocover ("Exit short at EP from L4L5") posPerLevel contract total next bar at ep limit;
    buy ("Long at L-1 from L4L5") posPerLevel contract next bar at ep-1*levelDiff limit;
    buy ("Long at L-2 from L4L5") posPerLevel contract next bar at ep-2*levelDiff limit;
    buy ("Long at L-3 from L4L5") posPerLevel contract next bar at ep-3*levelDiff limit;
    buy ("Long at L-4 from L4L5") posPerLevel contract next bar at ep-4*levelDiff limit;
    buy ("Long at L-5 from L4L5") posPerLevel contract next bar at ep-5*levelDiff limit;
    buy ("Long at L-6 from L4L5") posPerLevel contract next bar at ep-6*levelDiff limit;
    buy ("Long at L-7 from L4L5") posPerLevel contract next bar at ep-7*levelDiff limit;
    buy ("Long at L-8 from L4L5") posPerLevel contract next bar at ep-8*levelDiff limit;
    buy ("Long at L-9 from L4L5") posPerLevel contract next bar at ep-9*levelDiff limit;
    buy ("Long at L-10 from L4L5") posPerLevel contract next bar at ep-10*levelDiff limit;
    buy ("Long at L-11 from L4L5") posPerLevel contract next bar at ep-11*levelDiff limit;
end;
if close>=ep+3*levelDiff and close<ep+4*levelDiff then begin 
    sellshort ("Short at L11 from L3L4") posPerLevel contracts next bar at ep+11*levelDiff limit;
    sellshort ("Short at L10 from L3L4") posPerLevel contracts next bar at ep+10*levelDiff limit;
    sellshort ("Short at L9 from L3L4") posPerLevel contracts next bar at ep+9*levelDiff limit;
    sellshort ("Short at L8 from L3L4") posPerLevel contracts next bar at ep+8*levelDiff limit;
    sellshort ("Short at L7 from L3L4") posPerLevel contracts next bar at ep+7*levelDiff limit;
    sellshort ("Short at L6 from L3L4") posPerLevel contracts next bar at ep+6*levelDiff limit;
    sellshort ("Short at L5 from L3L4") posPerLevel contracts next bar at ep+5*levelDiff limit;
    if currentcontracts=3 or isDayOpen then begin
        sellshort("Short at L4 from L3L4") posPerLevel contracts next bar at ep+4*levelDiff limit; 
    end;
    if currentcontracts=4 then 
        buytocover ("Exit short at L3 from L3L4") posPerLevel contract total next bar at ep+3*levelDiff limit;
    end;
    buytocover ("Exit short at L2 from L3L4") posPerLevel contract total next bar at ep+2*levelDiff limit;
    buytocover ("Exit short at L1 from L3L4") posPerLevel contract total next bar at ep+1*levelDiff limit;
    buytocover ("Exit short at EP from L3L4") posPerLevel contract total next bar at ep limit;
    buy ("Long at L-1 from L3L4") posPerLevel contract next bar at ep-1*levelDiff limit;
    buy ("Long at L-2 from L3L4") posPerLevel contract next bar at ep-2*levelDiff limit;
    buy ("Long at L-3 from L3L4") posPerLevel contract next bar at ep-3*levelDiff limit;
    buy ("Long at L-4 from L3L4") posPerLevel contract next bar at ep-4*levelDiff limit;
    buy ("Long at L-5 from L3L4") posPerLevel contract next bar at ep-5*levelDiff limit;
    buy ("Long at L-6 from L3L4") posPerLevel contract next bar at ep-6*levelDiff limit;
    buy ("Long at L-7 from L3L4") posPerLevel contract next bar at ep-7*levelDiff limit;
    buy ("Long at L-8 from L3L4") posPerLevel contract next bar at ep-8*levelDiff limit;
    buy ("Long at L-9 from L3L4") posPerLevel contract next bar at ep-9*levelDiff limit;
    buy ("Long at L-10 from L3L4") posPerLevel contract next bar at ep-10*levelDiff limit;
    buy ("Long at L-11 from L3L4") posPerLevel contract next bar at ep-11*levelDiff limit;
end;
if close>=ep+2*levelDiff and close<ep+3*levelDiff then begin 
    sellshort ("Short at L11 from L2L3") posPerLevel contracts next bar at ep+11*levelDiff limit;
    sellshort ("Short at L10 from L2L3") posPerLevel contracts next bar at ep+10*levelDiff limit;
    sellshort ("Short at L9 from L2L3") posPerLevel contracts next bar at ep+9*levelDiff limit;
    sellshort ("Short at L8 from L2L3") posPerLevel contracts next bar at ep+8*levelDiff limit;
    sellshort ("Short at L7 from L2L3") posPerLevel contracts next bar at ep+7*levelDiff limit;
    sellshort ("Short at L6 from L2L3") posPerLevel contracts next bar at ep+6*levelDiff limit;
    sellshort ("Short at L5 from L2L3") posPerLevel contracts next bar at ep+5*levelDiff limit;
    sellshort ("Short at L4 from L2L3") posPerLevel contracts next bar at ep+4*levelDiff limit;
    if currentcontracts=2 or isDayOpen then begin
        sellshort("Short at L3 from L2L3") posPerLevel contracts next bar at ep+3*levelDiff limit; 
    end;
    if currentcontracts=3 then 
        buytocover ("Exit short at L2 from L2L3") posPerLevel contract total next bar at ep+2*levelDiff limit;
    end;
    buytocover ("Exit short at L1 from L2L3") posPerLevel contract total next bar at ep+1*levelDiff limit;
    buytocover ("Exit short at EP from L2L3") posPerLevel contract total next bar at ep limit;
    buy ("Long at L-1 from L2L3") posPerLevel contract next bar at ep-1*levelDiff limit;
    buy ("Long at L-2 from L2L3") posPerLevel contract next bar at ep-2*levelDiff limit;
    buy ("Long at L-3 from L2L3") posPerLevel contract next bar at ep-3*levelDiff limit;
    buy ("Long at L-4 from L2L3") posPerLevel contract next bar at ep-4*levelDiff limit;
    buy ("Long at L-5 from L2L3") posPerLevel contract next bar at ep-5*levelDiff limit;
    buy ("Long at L-6 from L2L3") posPerLevel contract next bar at ep-6*levelDiff limit;
    buy ("Long at L-7 from L2L3") posPerLevel contract next bar at ep-7*levelDiff limit;
    buy ("Long at L-8 from L2L3") posPerLevel contract next bar at ep-8*levelDiff limit;
    buy ("Long at L-9 from L2L3") posPerLevel contract next bar at ep-9*levelDiff limit;
    buy ("Long at L-10 from L2L3") posPerLevel contract next bar at ep-10*levelDiff limit;
    buy ("Long at L-11 from L2L3") posPerLevel contract next bar at ep-11*levelDiff limit;
end;
if close>=ep+1*levelDiff and close<ep+2*levelDiff then begin 
    sellshort ("Short at L11 from L1L2") posPerLevel contracts next bar at ep+11*levelDiff limit;
    sellshort ("Short at L10 from L1L2") posPerLevel contracts next bar at ep+10*levelDiff limit;
    sellshort ("Short at L9 from L1L2") posPerLevel contracts next bar at ep+9*levelDiff limit;
    sellshort ("Short at L8 from L1L2") posPerLevel contracts next bar at ep+8*levelDiff limit;
    sellshort ("Short at L7 from L1L2") posPerLevel contracts next bar at ep+7*levelDiff limit;
    sellshort ("Short at L6 from L1L2") posPerLevel contracts next bar at ep+6*levelDiff limit;
    sellshort ("Short at L5 from L1L2") posPerLevel contracts next bar at ep+5*levelDiff limit;
    sellshort ("Short at L4 from L1L2") posPerLevel contracts next bar at ep+4*levelDiff limit;
    sellshort ("Short at L3 from L1L2") posPerLevel contracts next bar at ep+3*levelDiff limit;
    if currentcontracts=1 or isDayOpen then begin
        sellshort("Short at L2 from L1L2") posPerLevel contracts next bar at ep+2*levelDiff limit; 
    end;
    if currentcontracts=2 then 
        buytocover ("Exit short at L1 from L1L2") posPerLevel contract total next bar at ep+1*levelDiff limit;
    end;
    buytocover ("Exit short at EP from L1L2") posPerLevel contract total next bar at ep limit;
    buy ("Long at L-1 from L1L2") posPerLevel contract next bar at ep-1*levelDiff limit;
    buy ("Long at L-2 from L1L2") posPerLevel contract next bar at ep-2*levelDiff limit;
    buy ("Long at L-3 from L1L2") posPerLevel contract next bar at ep-3*levelDiff limit;
    buy ("Long at L-4 from L1L2") posPerLevel contract next bar at ep-4*levelDiff limit;
    buy ("Long at L-5 from L1L2") posPerLevel contract next bar at ep-5*levelDiff limit;
    buy ("Long at L-6 from L1L2") posPerLevel contract next bar at ep-6*levelDiff limit;
    buy ("Long at L-7 from L1L2") posPerLevel contract next bar at ep-7*levelDiff limit;
    buy ("Long at L-8 from L1L2") posPerLevel contract next bar at ep-8*levelDiff limit;
    buy ("Long at L-9 from L1L2") posPerLevel contract next bar at ep-9*levelDiff limit;
    buy ("Long at L-10 from L1L2") posPerLevel contract next bar at ep-10*levelDiff limit;
    buy ("Long at L-11 from L1L2") posPerLevel contract next bar at ep-11*levelDiff limit;
end;
if close>=ep+0*levelDiff and close<ep+1*levelDiff then begin 
    sellshort ("Short at L11 from L0L1") posPerLevel contracts next bar at ep+11*levelDiff limit;
    sellshort ("Short at L10 from L0L1") posPerLevel contracts next bar at ep+10*levelDiff limit;
    sellshort ("Short at L9 from L0L1") posPerLevel contracts next bar at ep+9*levelDiff limit;
    sellshort ("Short at L8 from L0L1") posPerLevel contracts next bar at ep+8*levelDiff limit;
    sellshort ("Short at L7 from L0L1") posPerLevel contracts next bar at ep+7*levelDiff limit;
    sellshort ("Short at L6 from L0L1") posPerLevel contracts next bar at ep+6*levelDiff limit;
    sellshort ("Short at L5 from L0L1") posPerLevel contracts next bar at ep+5*levelDiff limit;
    sellshort ("Short at L4 from L0L1") posPerLevel contracts next bar at ep+4*levelDiff limit;
    sellshort ("Short at L3 from L0L1") posPerLevel contracts next bar at ep+3*levelDiff limit;
    sellshort ("Short at L2 from L0L1") posPerLevel contracts next bar at ep+2*levelDiff limit;
    if currentcontracts=0 or isDayOpen then begin
        sellshort("Short at L1 from L0L1") posPerLevel contracts next bar at ep+1*levelDiff limit; 
    end;
    if currentcontracts=1 then 
        buytocover ("Exit short at L0 from L0L1") posPerLevel contract total next bar at ep+0*levelDiff limit;
    end;
    buy ("Long at L-1 from L0L1") posPerLevel contract next bar at ep-1*levelDiff limit;
    buy ("Long at L-2 from L0L1") posPerLevel contract next bar at ep-2*levelDiff limit;
    buy ("Long at L-3 from L0L1") posPerLevel contract next bar at ep-3*levelDiff limit;
    buy ("Long at L-4 from L0L1") posPerLevel contract next bar at ep-4*levelDiff limit;
    buy ("Long at L-5 from L0L1") posPerLevel contract next bar at ep-5*levelDiff limit;
    buy ("Long at L-6 from L0L1") posPerLevel contract next bar at ep-6*levelDiff limit;
    buy ("Long at L-7 from L0L1") posPerLevel contract next bar at ep-7*levelDiff limit;
    buy ("Long at L-8 from L0L1") posPerLevel contract next bar at ep-8*levelDiff limit;
    buy ("Long at L-9 from L0L1") posPerLevel contract next bar at ep-9*levelDiff limit;
    buy ("Long at L-10 from L0L1") posPerLevel contract next bar at ep-10*levelDiff limit;
    buy ("Long at L-11 from L0L1") posPerLevel contract next bar at ep-11*levelDiff limit;
end;
if close>=ep+-1*levelDiff and close<ep+0*levelDiff then begin 
    sellshort ("Short at L11 from L-1L0") posPerLevel contracts next bar at ep+11*levelDiff limit;
    sellshort ("Short at L10 from L-1L0") posPerLevel contracts next bar at ep+10*levelDiff limit;
    sellshort ("Short at L9 from L-1L0") posPerLevel contracts next bar at ep+9*levelDiff limit;
    sellshort ("Short at L8 from L-1L0") posPerLevel contracts next bar at ep+8*levelDiff limit;
    sellshort ("Short at L7 from L-1L0") posPerLevel contracts next bar at ep+7*levelDiff limit;
    sellshort ("Short at L6 from L-1L0") posPerLevel contracts next bar at ep+6*levelDiff limit;
    sellshort ("Short at L5 from L-1L0") posPerLevel contracts next bar at ep+5*levelDiff limit;
    sellshort ("Short at L4 from L-1L0") posPerLevel contracts next bar at ep+4*levelDiff limit;
    sellshort ("Short at L3 from L-1L0") posPerLevel contracts next bar at ep+3*levelDiff limit;
    sellshort ("Short at L2 from L-1L0") posPerLevel contracts next bar at ep+2*levelDiff limit;
    sellshort ("Short at L1 from L-1L0") posPerLevel contracts next bar at ep+1*levelDiff limit;
    if currentcontracts=-1 or isDayOpen then begin
        sellshort("Short at L0 from L-1L0") posPerLevel contracts next bar at ep+0*levelDiff limit; 
    end;
    if currentcontracts=0 then 
        buytocover ("Exit short at L-1 from L-1L0") posPerLevel contract total next bar at ep+-1*levelDiff limit;
    end;
    buytocover ("Exit short at EP from L-1L0") posPerLevel contract total next bar at ep limit;
    buy ("Long at L-1 from L-1L0") posPerLevel contract next bar at ep-1*levelDiff limit;
    buy ("Long at L-2 from L-1L0") posPerLevel contract next bar at ep-2*levelDiff limit;
    buy ("Long at L-3 from L-1L0") posPerLevel contract next bar at ep-3*levelDiff limit;
    buy ("Long at L-4 from L-1L0") posPerLevel contract next bar at ep-4*levelDiff limit;
    buy ("Long at L-5 from L-1L0") posPerLevel contract next bar at ep-5*levelDiff limit;
    buy ("Long at L-6 from L-1L0") posPerLevel contract next bar at ep-6*levelDiff limit;
    buy ("Long at L-7 from L-1L0") posPerLevel contract next bar at ep-7*levelDiff limit;
    buy ("Long at L-8 from L-1L0") posPerLevel contract next bar at ep-8*levelDiff limit;
    buy ("Long at L-9 from L-1L0") posPerLevel contract next bar at ep-9*levelDiff limit;
    buy ("Long at L-10 from L-1L0") posPerLevel contract next bar at ep-10*levelDiff limit;
    buy ("Long at L-11 from L-1L0") posPerLevel contract next bar at ep-11*levelDiff limit;
end;
if close>=ep+-2*levelDiff and close<ep+-1*levelDiff then begin 
    sellshort ("Short at L11 from L-2L-1") posPerLevel contracts next bar at ep+11*levelDiff limit;
    sellshort ("Short at L10 from L-2L-1") posPerLevel contracts next bar at ep+10*levelDiff limit;
    sellshort ("Short at L9 from L-2L-1") posPerLevel contracts next bar at ep+9*levelDiff limit;
    sellshort ("Short at L8 from L-2L-1") posPerLevel contracts next bar at ep+8*levelDiff limit;
    sellshort ("Short at L7 from L-2L-1") posPerLevel contracts next bar at ep+7*levelDiff limit;
    sellshort ("Short at L6 from L-2L-1") posPerLevel contracts next bar at ep+6*levelDiff limit;
    sellshort ("Short at L5 from L-2L-1") posPerLevel contracts next bar at ep+5*levelDiff limit;
    sellshort ("Short at L4 from L-2L-1") posPerLevel contracts next bar at ep+4*levelDiff limit;
    sellshort ("Short at L3 from L-2L-1") posPerLevel contracts next bar at ep+3*levelDiff limit;
    sellshort ("Short at L2 from L-2L-1") posPerLevel contracts next bar at ep+2*levelDiff limit;
    sellshort ("Short at L1 from L-2L-1") posPerLevel contracts next bar at ep+1*levelDiff limit;
    sellshort ("Short at L0 from L-2L-1") posPerLevel contracts next bar at ep+0*levelDiff limit;
    if currentcontracts=-2 or isDayOpen then begin
        sellshort("Short at L-1 from L-2L-1") posPerLevel contracts next bar at ep+-1*levelDiff limit; 
    end;
    if currentcontracts=-1 then 
        buytocover ("Exit short at L-2 from L-2L-1") posPerLevel contract total next bar at ep+-2*levelDiff limit;
    end;
    buytocover ("Exit short at EP from L-2L-1") posPerLevel contract total next bar at ep limit;
    buy ("Long at L-1 from L-2L-1") posPerLevel contract next bar at ep-1*levelDiff limit;
    buy ("Long at L-2 from L-2L-1") posPerLevel contract next bar at ep-2*levelDiff limit;
    buy ("Long at L-3 from L-2L-1") posPerLevel contract next bar at ep-3*levelDiff limit;
    buy ("Long at L-4 from L-2L-1") posPerLevel contract next bar at ep-4*levelDiff limit;
    buy ("Long at L-5 from L-2L-1") posPerLevel contract next bar at ep-5*levelDiff limit;
    buy ("Long at L-6 from L-2L-1") posPerLevel contract next bar at ep-6*levelDiff limit;
    buy ("Long at L-7 from L-2L-1") posPerLevel contract next bar at ep-7*levelDiff limit;
    buy ("Long at L-8 from L-2L-1") posPerLevel contract next bar at ep-8*levelDiff limit;
    buy ("Long at L-9 from L-2L-1") posPerLevel contract next bar at ep-9*levelDiff limit;
    buy ("Long at L-10 from L-2L-1") posPerLevel contract next bar at ep-10*levelDiff limit;
    buy ("Long at L-11 from L-2L-1") posPerLevel contract next bar at ep-11*levelDiff limit;
end;
if close>=ep+-3*levelDiff and close<ep+-2*levelDiff then begin 
    sellshort ("Short at L11 from L-3L-2") posPerLevel contracts next bar at ep+11*levelDiff limit;
    sellshort ("Short at L10 from L-3L-2") posPerLevel contracts next bar at ep+10*levelDiff limit;
    sellshort ("Short at L9 from L-3L-2") posPerLevel contracts next bar at ep+9*levelDiff limit;
    sellshort ("Short at L8 from L-3L-2") posPerLevel contracts next bar at ep+8*levelDiff limit;
    sellshort ("Short at L7 from L-3L-2") posPerLevel contracts next bar at ep+7*levelDiff limit;
    sellshort ("Short at L6 from L-3L-2") posPerLevel contracts next bar at ep+6*levelDiff limit;
    sellshort ("Short at L5 from L-3L-2") posPerLevel contracts next bar at ep+5*levelDiff limit;
    sellshort ("Short at L4 from L-3L-2") posPerLevel contracts next bar at ep+4*levelDiff limit;
    sellshort ("Short at L3 from L-3L-2") posPerLevel contracts next bar at ep+3*levelDiff limit;
    sellshort ("Short at L2 from L-3L-2") posPerLevel contracts next bar at ep+2*levelDiff limit;
    sellshort ("Short at L1 from L-3L-2") posPerLevel contracts next bar at ep+1*levelDiff limit;
    sellshort ("Short at L0 from L-3L-2") posPerLevel contracts next bar at ep+0*levelDiff limit;
    sellshort ("Short at L-1 from L-3L-2") posPerLevel contracts next bar at ep+-1*levelDiff limit;
    if currentcontracts=-3 or isDayOpen then begin
        sellshort("Short at L-2 from L-3L-2") posPerLevel contracts next bar at ep+-2*levelDiff limit; 
    end;
    if currentcontracts=-2 then 
        buytocover ("Exit short at L-3 from L-3L-2") posPerLevel contract total next bar at ep+-3*levelDiff limit;
    end;
    buytocover ("Exit short at EP from L-3L-2") posPerLevel contract total next bar at ep limit;
    buy ("Long at L-1 from L-3L-2") posPerLevel contract next bar at ep-1*levelDiff limit;
    buy ("Long at L-2 from L-3L-2") posPerLevel contract next bar at ep-2*levelDiff limit;
    buy ("Long at L-3 from L-3L-2") posPerLevel contract next bar at ep-3*levelDiff limit;
    buy ("Long at L-4 from L-3L-2") posPerLevel contract next bar at ep-4*levelDiff limit;
    buy ("Long at L-5 from L-3L-2") posPerLevel contract next bar at ep-5*levelDiff limit;
    buy ("Long at L-6 from L-3L-2") posPerLevel contract next bar at ep-6*levelDiff limit;
    buy ("Long at L-7 from L-3L-2") posPerLevel contract next bar at ep-7*levelDiff limit;
    buy ("Long at L-8 from L-3L-2") posPerLevel contract next bar at ep-8*levelDiff limit;
    buy ("Long at L-9 from L-3L-2") posPerLevel contract next bar at ep-9*levelDiff limit;
    buy ("Long at L-10 from L-3L-2") posPerLevel contract next bar at ep-10*levelDiff limit;
    buy ("Long at L-11 from L-3L-2") posPerLevel contract next bar at ep-11*levelDiff limit;
end;
if close>=ep+-4*levelDiff and close<ep+-3*levelDiff then begin 
    sellshort ("Short at L11 from L-4L-3") posPerLevel contracts next bar at ep+11*levelDiff limit;
    sellshort ("Short at L10 from L-4L-3") posPerLevel contracts next bar at ep+10*levelDiff limit;
    sellshort ("Short at L9 from L-4L-3") posPerLevel contracts next bar at ep+9*levelDiff limit;
    sellshort ("Short at L8 from L-4L-3") posPerLevel contracts next bar at ep+8*levelDiff limit;
    sellshort ("Short at L7 from L-4L-3") posPerLevel contracts next bar at ep+7*levelDiff limit;
    sellshort ("Short at L6 from L-4L-3") posPerLevel contracts next bar at ep+6*levelDiff limit;
    sellshort ("Short at L5 from L-4L-3") posPerLevel contracts next bar at ep+5*levelDiff limit;
    sellshort ("Short at L4 from L-4L-3") posPerLevel contracts next bar at ep+4*levelDiff limit;
    sellshort ("Short at L3 from L-4L-3") posPerLevel contracts next bar at ep+3*levelDiff limit;
    sellshort ("Short at L2 from L-4L-3") posPerLevel contracts next bar at ep+2*levelDiff limit;
    sellshort ("Short at L1 from L-4L-3") posPerLevel contracts next bar at ep+1*levelDiff limit;
    sellshort ("Short at L0 from L-4L-3") posPerLevel contracts next bar at ep+0*levelDiff limit;
    sellshort ("Short at L-1 from L-4L-3") posPerLevel contracts next bar at ep+-1*levelDiff limit;
    sellshort ("Short at L-2 from L-4L-3") posPerLevel contracts next bar at ep+-2*levelDiff limit;
    if currentcontracts=-4 or isDayOpen then begin
        sellshort("Short at L-3 from L-4L-3") posPerLevel contracts next bar at ep+-3*levelDiff limit; 
    end;
    if currentcontracts=-3 then 
        buytocover ("Exit short at L-4 from L-4L-3") posPerLevel contract total next bar at ep+-4*levelDiff limit;
    end;
    buytocover ("Exit short at EP from L-4L-3") posPerLevel contract total next bar at ep limit;
    buy ("Long at L-1 from L-4L-3") posPerLevel contract next bar at ep-1*levelDiff limit;
    buy ("Long at L-2 from L-4L-3") posPerLevel contract next bar at ep-2*levelDiff limit;
    buy ("Long at L-3 from L-4L-3") posPerLevel contract next bar at ep-3*levelDiff limit;
    buy ("Long at L-4 from L-4L-3") posPerLevel contract next bar at ep-4*levelDiff limit;
    buy ("Long at L-5 from L-4L-3") posPerLevel contract next bar at ep-5*levelDiff limit;
    buy ("Long at L-6 from L-4L-3") posPerLevel contract next bar at ep-6*levelDiff limit;
    buy ("Long at L-7 from L-4L-3") posPerLevel contract next bar at ep-7*levelDiff limit;
    buy ("Long at L-8 from L-4L-3") posPerLevel contract next bar at ep-8*levelDiff limit;
    buy ("Long at L-9 from L-4L-3") posPerLevel contract next bar at ep-9*levelDiff limit;
    buy ("Long at L-10 from L-4L-3") posPerLevel contract next bar at ep-10*levelDiff limit;
    buy ("Long at L-11 from L-4L-3") posPerLevel contract next bar at ep-11*levelDiff limit;
end;
if close>=ep+-5*levelDiff and close<ep+-4*levelDiff then begin 
    sellshort ("Short at L11 from L-5L-4") posPerLevel contracts next bar at ep+11*levelDiff limit;
    sellshort ("Short at L10 from L-5L-4") posPerLevel contracts next bar at ep+10*levelDiff limit;
    sellshort ("Short at L9 from L-5L-4") posPerLevel contracts next bar at ep+9*levelDiff limit;
    sellshort ("Short at L8 from L-5L-4") posPerLevel contracts next bar at ep+8*levelDiff limit;
    sellshort ("Short at L7 from L-5L-4") posPerLevel contracts next bar at ep+7*levelDiff limit;
    sellshort ("Short at L6 from L-5L-4") posPerLevel contracts next bar at ep+6*levelDiff limit;
    sellshort ("Short at L5 from L-5L-4") posPerLevel contracts next bar at ep+5*levelDiff limit;
    sellshort ("Short at L4 from L-5L-4") posPerLevel contracts next bar at ep+4*levelDiff limit;
    sellshort ("Short at L3 from L-5L-4") posPerLevel contracts next bar at ep+3*levelDiff limit;
    sellshort ("Short at L2 from L-5L-4") posPerLevel contracts next bar at ep+2*levelDiff limit;
    sellshort ("Short at L1 from L-5L-4") posPerLevel contracts next bar at ep+1*levelDiff limit;
    sellshort ("Short at L0 from L-5L-4") posPerLevel contracts next bar at ep+0*levelDiff limit;
    sellshort ("Short at L-1 from L-5L-4") posPerLevel contracts next bar at ep+-1*levelDiff limit;
    sellshort ("Short at L-2 from L-5L-4") posPerLevel contracts next bar at ep+-2*levelDiff limit;
    sellshort ("Short at L-3 from L-5L-4") posPerLevel contracts next bar at ep+-3*levelDiff limit;
    if currentcontracts=-5 or isDayOpen then begin
        sellshort("Short at L-4 from L-5L-4") posPerLevel contracts next bar at ep+-4*levelDiff limit; 
    end;
    if currentcontracts=-4 then 
        buytocover ("Exit short at L-5 from L-5L-4") posPerLevel contract total next bar at ep+-5*levelDiff limit;
    end;
    buytocover ("Exit short at EP from L-5L-4") posPerLevel contract total next bar at ep limit;
    buy ("Long at L-1 from L-5L-4") posPerLevel contract next bar at ep-1*levelDiff limit;
    buy ("Long at L-2 from L-5L-4") posPerLevel contract next bar at ep-2*levelDiff limit;
    buy ("Long at L-3 from L-5L-4") posPerLevel contract next bar at ep-3*levelDiff limit;
    buy ("Long at L-4 from L-5L-4") posPerLevel contract next bar at ep-4*levelDiff limit;
    buy ("Long at L-5 from L-5L-4") posPerLevel contract next bar at ep-5*levelDiff limit;
    buy ("Long at L-6 from L-5L-4") posPerLevel contract next bar at ep-6*levelDiff limit;
    buy ("Long at L-7 from L-5L-4") posPerLevel contract next bar at ep-7*levelDiff limit;
    buy ("Long at L-8 from L-5L-4") posPerLevel contract next bar at ep-8*levelDiff limit;
    buy ("Long at L-9 from L-5L-4") posPerLevel contract next bar at ep-9*levelDiff limit;
    buy ("Long at L-10 from L-5L-4") posPerLevel contract next bar at ep-10*levelDiff limit;
    buy ("Long at L-11 from L-5L-4") posPerLevel contract next bar at ep-11*levelDiff limit;
end;
if close>=ep+-6*levelDiff and close<ep+-5*levelDiff then begin 
    sellshort ("Short at L11 from L-6L-5") posPerLevel contracts next bar at ep+11*levelDiff limit;
    sellshort ("Short at L10 from L-6L-5") posPerLevel contracts next bar at ep+10*levelDiff limit;
    sellshort ("Short at L9 from L-6L-5") posPerLevel contracts next bar at ep+9*levelDiff limit;
    sellshort ("Short at L8 from L-6L-5") posPerLevel contracts next bar at ep+8*levelDiff limit;
    sellshort ("Short at L7 from L-6L-5") posPerLevel contracts next bar at ep+7*levelDiff limit;
    sellshort ("Short at L6 from L-6L-5") posPerLevel contracts next bar at ep+6*levelDiff limit;
    sellshort ("Short at L5 from L-6L-5") posPerLevel contracts next bar at ep+5*levelDiff limit;
    sellshort ("Short at L4 from L-6L-5") posPerLevel contracts next bar at ep+4*levelDiff limit;
    sellshort ("Short at L3 from L-6L-5") posPerLevel contracts next bar at ep+3*levelDiff limit;
    sellshort ("Short at L2 from L-6L-5") posPerLevel contracts next bar at ep+2*levelDiff limit;
    sellshort ("Short at L1 from L-6L-5") posPerLevel contracts next bar at ep+1*levelDiff limit;
    sellshort ("Short at L0 from L-6L-5") posPerLevel contracts next bar at ep+0*levelDiff limit;
    sellshort ("Short at L-1 from L-6L-5") posPerLevel contracts next bar at ep+-1*levelDiff limit;
    sellshort ("Short at L-2 from L-6L-5") posPerLevel contracts next bar at ep+-2*levelDiff limit;
    sellshort ("Short at L-3 from L-6L-5") posPerLevel contracts next bar at ep+-3*levelDiff limit;
    sellshort ("Short at L-4 from L-6L-5") posPerLevel contracts next bar at ep+-4*levelDiff limit;
    if currentcontracts=-6 or isDayOpen then begin
        sellshort("Short at L-5 from L-6L-5") posPerLevel contracts next bar at ep+-5*levelDiff limit; 
    end;
    if currentcontracts=-5 then 
        buytocover ("Exit short at L-6 from L-6L-5") posPerLevel contract total next bar at ep+-6*levelDiff limit;
    end;
    buytocover ("Exit short at EP from L-6L-5") posPerLevel contract total next bar at ep limit;
    buy ("Long at L-1 from L-6L-5") posPerLevel contract next bar at ep-1*levelDiff limit;
    buy ("Long at L-2 from L-6L-5") posPerLevel contract next bar at ep-2*levelDiff limit;
    buy ("Long at L-3 from L-6L-5") posPerLevel contract next bar at ep-3*levelDiff limit;
    buy ("Long at L-4 from L-6L-5") posPerLevel contract next bar at ep-4*levelDiff limit;
    buy ("Long at L-5 from L-6L-5") posPerLevel contract next bar at ep-5*levelDiff limit;
    buy ("Long at L-6 from L-6L-5") posPerLevel contract next bar at ep-6*levelDiff limit;
    buy ("Long at L-7 from L-6L-5") posPerLevel contract next bar at ep-7*levelDiff limit;
    buy ("Long at L-8 from L-6L-5") posPerLevel contract next bar at ep-8*levelDiff limit;
    buy ("Long at L-9 from L-6L-5") posPerLevel contract next bar at ep-9*levelDiff limit;
    buy ("Long at L-10 from L-6L-5") posPerLevel contract next bar at ep-10*levelDiff limit;
    buy ("Long at L-11 from L-6L-5") posPerLevel contract next bar at ep-11*levelDiff limit;
end;
if close>=ep+-7*levelDiff and close<ep+-6*levelDiff then begin 
    sellshort ("Short at L11 from L-7L-6") posPerLevel contracts next bar at ep+11*levelDiff limit;
    sellshort ("Short at L10 from L-7L-6") posPerLevel contracts next bar at ep+10*levelDiff limit;
    sellshort ("Short at L9 from L-7L-6") posPerLevel contracts next bar at ep+9*levelDiff limit;
    sellshort ("Short at L8 from L-7L-6") posPerLevel contracts next bar at ep+8*levelDiff limit;
    sellshort ("Short at L7 from L-7L-6") posPerLevel contracts next bar at ep+7*levelDiff limit;
    sellshort ("Short at L6 from L-7L-6") posPerLevel contracts next bar at ep+6*levelDiff limit;
    sellshort ("Short at L5 from L-7L-6") posPerLevel contracts next bar at ep+5*levelDiff limit;
    sellshort ("Short at L4 from L-7L-6") posPerLevel contracts next bar at ep+4*levelDiff limit;
    sellshort ("Short at L3 from L-7L-6") posPerLevel contracts next bar at ep+3*levelDiff limit;
    sellshort ("Short at L2 from L-7L-6") posPerLevel contracts next bar at ep+2*levelDiff limit;
    sellshort ("Short at L1 from L-7L-6") posPerLevel contracts next bar at ep+1*levelDiff limit;
    sellshort ("Short at L0 from L-7L-6") posPerLevel contracts next bar at ep+0*levelDiff limit;
    sellshort ("Short at L-1 from L-7L-6") posPerLevel contracts next bar at ep+-1*levelDiff limit;
    sellshort ("Short at L-2 from L-7L-6") posPerLevel contracts next bar at ep+-2*levelDiff limit;
    sellshort ("Short at L-3 from L-7L-6") posPerLevel contracts next bar at ep+-3*levelDiff limit;
    sellshort ("Short at L-4 from L-7L-6") posPerLevel contracts next bar at ep+-4*levelDiff limit;
    sellshort ("Short at L-5 from L-7L-6") posPerLevel contracts next bar at ep+-5*levelDiff limit;
    if currentcontracts=-7 or isDayOpen then begin
        sellshort("Short at L-6 from L-7L-6") posPerLevel contracts next bar at ep+-6*levelDiff limit; 
    end;
    if currentcontracts=-6 then 
        buytocover ("Exit short at L-7 from L-7L-6") posPerLevel contract total next bar at ep+-7*levelDiff limit;
    end;
    buytocover ("Exit short at EP from L-7L-6") posPerLevel contract total next bar at ep limit;
    buy ("Long at L-1 from L-7L-6") posPerLevel contract next bar at ep-1*levelDiff limit;
    buy ("Long at L-2 from L-7L-6") posPerLevel contract next bar at ep-2*levelDiff limit;
    buy ("Long at L-3 from L-7L-6") posPerLevel contract next bar at ep-3*levelDiff limit;
    buy ("Long at L-4 from L-7L-6") posPerLevel contract next bar at ep-4*levelDiff limit;
    buy ("Long at L-5 from L-7L-6") posPerLevel contract next bar at ep-5*levelDiff limit;
    buy ("Long at L-6 from L-7L-6") posPerLevel contract next bar at ep-6*levelDiff limit;
    buy ("Long at L-7 from L-7L-6") posPerLevel contract next bar at ep-7*levelDiff limit;
    buy ("Long at L-8 from L-7L-6") posPerLevel contract next bar at ep-8*levelDiff limit;
    buy ("Long at L-9 from L-7L-6") posPerLevel contract next bar at ep-9*levelDiff limit;
    buy ("Long at L-10 from L-7L-6") posPerLevel contract next bar at ep-10*levelDiff limit;
    buy ("Long at L-11 from L-7L-6") posPerLevel contract next bar at ep-11*levelDiff limit;
end;
if close>=ep+-8*levelDiff and close<ep+-7*levelDiff then begin 
    sellshort ("Short at L11 from L-8L-7") posPerLevel contracts next bar at ep+11*levelDiff limit;
    sellshort ("Short at L10 from L-8L-7") posPerLevel contracts next bar at ep+10*levelDiff limit;
    sellshort ("Short at L9 from L-8L-7") posPerLevel contracts next bar at ep+9*levelDiff limit;
    sellshort ("Short at L8 from L-8L-7") posPerLevel contracts next bar at ep+8*levelDiff limit;
    sellshort ("Short at L7 from L-8L-7") posPerLevel contracts next bar at ep+7*levelDiff limit;
    sellshort ("Short at L6 from L-8L-7") posPerLevel contracts next bar at ep+6*levelDiff limit;
    sellshort ("Short at L5 from L-8L-7") posPerLevel contracts next bar at ep+5*levelDiff limit;
    sellshort ("Short at L4 from L-8L-7") posPerLevel contracts next bar at ep+4*levelDiff limit;
    sellshort ("Short at L3 from L-8L-7") posPerLevel contracts next bar at ep+3*levelDiff limit;
    sellshort ("Short at L2 from L-8L-7") posPerLevel contracts next bar at ep+2*levelDiff limit;
    sellshort ("Short at L1 from L-8L-7") posPerLevel contracts next bar at ep+1*levelDiff limit;
    sellshort ("Short at L0 from L-8L-7") posPerLevel contracts next bar at ep+0*levelDiff limit;
    sellshort ("Short at L-1 from L-8L-7") posPerLevel contracts next bar at ep+-1*levelDiff limit;
    sellshort ("Short at L-2 from L-8L-7") posPerLevel contracts next bar at ep+-2*levelDiff limit;
    sellshort ("Short at L-3 from L-8L-7") posPerLevel contracts next bar at ep+-3*levelDiff limit;
    sellshort ("Short at L-4 from L-8L-7") posPerLevel contracts next bar at ep+-4*levelDiff limit;
    sellshort ("Short at L-5 from L-8L-7") posPerLevel contracts next bar at ep+-5*levelDiff limit;
    sellshort ("Short at L-6 from L-8L-7") posPerLevel contracts next bar at ep+-6*levelDiff limit;
    if currentcontracts=-8 or isDayOpen then begin
        sellshort("Short at L-7 from L-8L-7") posPerLevel contracts next bar at ep+-7*levelDiff limit; 
    end;
    if currentcontracts=-7 then 
        buytocover ("Exit short at L-8 from L-8L-7") posPerLevel contract total next bar at ep+-8*levelDiff limit;
    end;
    buytocover ("Exit short at EP from L-8L-7") posPerLevel contract total next bar at ep limit;
    buy ("Long at L-1 from L-8L-7") posPerLevel contract next bar at ep-1*levelDiff limit;
    buy ("Long at L-2 from L-8L-7") posPerLevel contract next bar at ep-2*levelDiff limit;
    buy ("Long at L-3 from L-8L-7") posPerLevel contract next bar at ep-3*levelDiff limit;
    buy ("Long at L-4 from L-8L-7") posPerLevel contract next bar at ep-4*levelDiff limit;
    buy ("Long at L-5 from L-8L-7") posPerLevel contract next bar at ep-5*levelDiff limit;
    buy ("Long at L-6 from L-8L-7") posPerLevel contract next bar at ep-6*levelDiff limit;
    buy ("Long at L-7 from L-8L-7") posPerLevel contract next bar at ep-7*levelDiff limit;
    buy ("Long at L-8 from L-8L-7") posPerLevel contract next bar at ep-8*levelDiff limit;
    buy ("Long at L-9 from L-8L-7") posPerLevel contract next bar at ep-9*levelDiff limit;
    buy ("Long at L-10 from L-8L-7") posPerLevel contract next bar at ep-10*levelDiff limit;
    buy ("Long at L-11 from L-8L-7") posPerLevel contract next bar at ep-11*levelDiff limit;
end;
if close>=ep+-9*levelDiff and close<ep+-8*levelDiff then begin 
    sellshort ("Short at L11 from L-9L-8") posPerLevel contracts next bar at ep+11*levelDiff limit;
    sellshort ("Short at L10 from L-9L-8") posPerLevel contracts next bar at ep+10*levelDiff limit;
    sellshort ("Short at L9 from L-9L-8") posPerLevel contracts next bar at ep+9*levelDiff limit;
    sellshort ("Short at L8 from L-9L-8") posPerLevel contracts next bar at ep+8*levelDiff limit;
    sellshort ("Short at L7 from L-9L-8") posPerLevel contracts next bar at ep+7*levelDiff limit;
    sellshort ("Short at L6 from L-9L-8") posPerLevel contracts next bar at ep+6*levelDiff limit;
    sellshort ("Short at L5 from L-9L-8") posPerLevel contracts next bar at ep+5*levelDiff limit;
    sellshort ("Short at L4 from L-9L-8") posPerLevel contracts next bar at ep+4*levelDiff limit;
    sellshort ("Short at L3 from L-9L-8") posPerLevel contracts next bar at ep+3*levelDiff limit;
    sellshort ("Short at L2 from L-9L-8") posPerLevel contracts next bar at ep+2*levelDiff limit;
    sellshort ("Short at L1 from L-9L-8") posPerLevel contracts next bar at ep+1*levelDiff limit;
    sellshort ("Short at L0 from L-9L-8") posPerLevel contracts next bar at ep+0*levelDiff limit;
    sellshort ("Short at L-1 from L-9L-8") posPerLevel contracts next bar at ep+-1*levelDiff limit;
    sellshort ("Short at L-2 from L-9L-8") posPerLevel contracts next bar at ep+-2*levelDiff limit;
    sellshort ("Short at L-3 from L-9L-8") posPerLevel contracts next bar at ep+-3*levelDiff limit;
    sellshort ("Short at L-4 from L-9L-8") posPerLevel contracts next bar at ep+-4*levelDiff limit;
    sellshort ("Short at L-5 from L-9L-8") posPerLevel contracts next bar at ep+-5*levelDiff limit;
    sellshort ("Short at L-6 from L-9L-8") posPerLevel contracts next bar at ep+-6*levelDiff limit;
    sellshort ("Short at L-7 from L-9L-8") posPerLevel contracts next bar at ep+-7*levelDiff limit;
    if currentcontracts=-9 or isDayOpen then begin
        sellshort("Short at L-8 from L-9L-8") posPerLevel contracts next bar at ep+-8*levelDiff limit; 
    end;
    if currentcontracts=-8 then 
        buytocover ("Exit short at L-9 from L-9L-8") posPerLevel contract total next bar at ep+-9*levelDiff limit;
    end;
    buytocover ("Exit short at EP from L-9L-8") posPerLevel contract total next bar at ep limit;
    buy ("Long at L-1 from L-9L-8") posPerLevel contract next bar at ep-1*levelDiff limit;
    buy ("Long at L-2 from L-9L-8") posPerLevel contract next bar at ep-2*levelDiff limit;
    buy ("Long at L-3 from L-9L-8") posPerLevel contract next bar at ep-3*levelDiff limit;
    buy ("Long at L-4 from L-9L-8") posPerLevel contract next bar at ep-4*levelDiff limit;
    buy ("Long at L-5 from L-9L-8") posPerLevel contract next bar at ep-5*levelDiff limit;
    buy ("Long at L-6 from L-9L-8") posPerLevel contract next bar at ep-6*levelDiff limit;
    buy ("Long at L-7 from L-9L-8") posPerLevel contract next bar at ep-7*levelDiff limit;
    buy ("Long at L-8 from L-9L-8") posPerLevel contract next bar at ep-8*levelDiff limit;
    buy ("Long at L-9 from L-9L-8") posPerLevel contract next bar at ep-9*levelDiff limit;
    buy ("Long at L-10 from L-9L-8") posPerLevel contract next bar at ep-10*levelDiff limit;
    buy ("Long at L-11 from L-9L-8") posPerLevel contract next bar at ep-11*levelDiff limit;
end;
if close>=ep+-10*levelDiff and close<ep+-9*levelDiff then begin 
    sellshort ("Short at L11 from L-10L-9") posPerLevel contracts next bar at ep+11*levelDiff limit;
    sellshort ("Short at L10 from L-10L-9") posPerLevel contracts next bar at ep+10*levelDiff limit;
    sellshort ("Short at L9 from L-10L-9") posPerLevel contracts next bar at ep+9*levelDiff limit;
    sellshort ("Short at L8 from L-10L-9") posPerLevel contracts next bar at ep+8*levelDiff limit;
    sellshort ("Short at L7 from L-10L-9") posPerLevel contracts next bar at ep+7*levelDiff limit;
    sellshort ("Short at L6 from L-10L-9") posPerLevel contracts next bar at ep+6*levelDiff limit;
    sellshort ("Short at L5 from L-10L-9") posPerLevel contracts next bar at ep+5*levelDiff limit;
    sellshort ("Short at L4 from L-10L-9") posPerLevel contracts next bar at ep+4*levelDiff limit;
    sellshort ("Short at L3 from L-10L-9") posPerLevel contracts next bar at ep+3*levelDiff limit;
    sellshort ("Short at L2 from L-10L-9") posPerLevel contracts next bar at ep+2*levelDiff limit;
    sellshort ("Short at L1 from L-10L-9") posPerLevel contracts next bar at ep+1*levelDiff limit;
    sellshort ("Short at L0 from L-10L-9") posPerLevel contracts next bar at ep+0*levelDiff limit;
    sellshort ("Short at L-1 from L-10L-9") posPerLevel contracts next bar at ep+-1*levelDiff limit;
    sellshort ("Short at L-2 from L-10L-9") posPerLevel contracts next bar at ep+-2*levelDiff limit;
    sellshort ("Short at L-3 from L-10L-9") posPerLevel contracts next bar at ep+-3*levelDiff limit;
    sellshort ("Short at L-4 from L-10L-9") posPerLevel contracts next bar at ep+-4*levelDiff limit;
    sellshort ("Short at L-5 from L-10L-9") posPerLevel contracts next bar at ep+-5*levelDiff limit;
    sellshort ("Short at L-6 from L-10L-9") posPerLevel contracts next bar at ep+-6*levelDiff limit;
    sellshort ("Short at L-7 from L-10L-9") posPerLevel contracts next bar at ep+-7*levelDiff limit;
    sellshort ("Short at L-8 from L-10L-9") posPerLevel contracts next bar at ep+-8*levelDiff limit;
    if currentcontracts=-10 or isDayOpen then begin
        sellshort("Short at L-9 from L-10L-9") posPerLevel contracts next bar at ep+-9*levelDiff limit; 
    end;
    if currentcontracts=-9 then 
        buytocover ("Exit short at L-10 from L-10L-9") posPerLevel contract total next bar at ep+-10*levelDiff limit;
    end;
    buytocover ("Exit short at EP from L-10L-9") posPerLevel contract total next bar at ep limit;
    buy ("Long at L-1 from L-10L-9") posPerLevel contract next bar at ep-1*levelDiff limit;
    buy ("Long at L-2 from L-10L-9") posPerLevel contract next bar at ep-2*levelDiff limit;
    buy ("Long at L-3 from L-10L-9") posPerLevel contract next bar at ep-3*levelDiff limit;
    buy ("Long at L-4 from L-10L-9") posPerLevel contract next bar at ep-4*levelDiff limit;
    buy ("Long at L-5 from L-10L-9") posPerLevel contract next bar at ep-5*levelDiff limit;
    buy ("Long at L-6 from L-10L-9") posPerLevel contract next bar at ep-6*levelDiff limit;
    buy ("Long at L-7 from L-10L-9") posPerLevel contract next bar at ep-7*levelDiff limit;
    buy ("Long at L-8 from L-10L-9") posPerLevel contract next bar at ep-8*levelDiff limit;
    buy ("Long at L-9 from L-10L-9") posPerLevel contract next bar at ep-9*levelDiff limit;
    buy ("Long at L-10 from L-10L-9") posPerLevel contract next bar at ep-10*levelDiff limit;
    buy ("Long at L-11 from L-10L-9") posPerLevel contract next bar at ep-11*levelDiff limit;
end;
if close>=ep+-11*levelDiff and close<ep+-10*levelDiff then begin 
    sellshort ("Short at L11 from L-11L-10") posPerLevel contracts next bar at ep+11*levelDiff limit;
    sellshort ("Short at L10 from L-11L-10") posPerLevel contracts next bar at ep+10*levelDiff limit;
    sellshort ("Short at L9 from L-11L-10") posPerLevel contracts next bar at ep+9*levelDiff limit;
    sellshort ("Short at L8 from L-11L-10") posPerLevel contracts next bar at ep+8*levelDiff limit;
    sellshort ("Short at L7 from L-11L-10") posPerLevel contracts next bar at ep+7*levelDiff limit;
    sellshort ("Short at L6 from L-11L-10") posPerLevel contracts next bar at ep+6*levelDiff limit;
    sellshort ("Short at L5 from L-11L-10") posPerLevel contracts next bar at ep+5*levelDiff limit;
    sellshort ("Short at L4 from L-11L-10") posPerLevel contracts next bar at ep+4*levelDiff limit;
    sellshort ("Short at L3 from L-11L-10") posPerLevel contracts next bar at ep+3*levelDiff limit;
    sellshort ("Short at L2 from L-11L-10") posPerLevel contracts next bar at ep+2*levelDiff limit;
    sellshort ("Short at L1 from L-11L-10") posPerLevel contracts next bar at ep+1*levelDiff limit;
    sellshort ("Short at L0 from L-11L-10") posPerLevel contracts next bar at ep+0*levelDiff limit;
    sellshort ("Short at L-1 from L-11L-10") posPerLevel contracts next bar at ep+-1*levelDiff limit;
    sellshort ("Short at L-2 from L-11L-10") posPerLevel contracts next bar at ep+-2*levelDiff limit;
    sellshort ("Short at L-3 from L-11L-10") posPerLevel contracts next bar at ep+-3*levelDiff limit;
    sellshort ("Short at L-4 from L-11L-10") posPerLevel contracts next bar at ep+-4*levelDiff limit;
    sellshort ("Short at L-5 from L-11L-10") posPerLevel contracts next bar at ep+-5*levelDiff limit;
    sellshort ("Short at L-6 from L-11L-10") posPerLevel contracts next bar at ep+-6*levelDiff limit;
    sellshort ("Short at L-7 from L-11L-10") posPerLevel contracts next bar at ep+-7*levelDiff limit;
    sellshort ("Short at L-8 from L-11L-10") posPerLevel contracts next bar at ep+-8*levelDiff limit;
    sellshort ("Short at L-9 from L-11L-10") posPerLevel contracts next bar at ep+-9*levelDiff limit;
    if currentcontracts=-11 or isDayOpen then begin
        sellshort("Short at L-10 from L-11L-10") posPerLevel contracts next bar at ep+-10*levelDiff limit; 
    end;
    if currentcontracts=-10 then 
        buytocover ("Exit short at L-11 from L-11L-10") posPerLevel contract total next bar at ep+-11*levelDiff limit;
    end;
    buytocover ("Exit short at EP from L-11L-10") posPerLevel contract total next bar at ep limit;
    buy ("Long at L-1 from L-11L-10") posPerLevel contract next bar at ep-1*levelDiff limit;
    buy ("Long at L-2 from L-11L-10") posPerLevel contract next bar at ep-2*levelDiff limit;
    buy ("Long at L-3 from L-11L-10") posPerLevel contract next bar at ep-3*levelDiff limit;
    buy ("Long at L-4 from L-11L-10") posPerLevel contract next bar at ep-4*levelDiff limit;
    buy ("Long at L-5 from L-11L-10") posPerLevel contract next bar at ep-5*levelDiff limit;
    buy ("Long at L-6 from L-11L-10") posPerLevel contract next bar at ep-6*levelDiff limit;
    buy ("Long at L-7 from L-11L-10") posPerLevel contract next bar at ep-7*levelDiff limit;
    buy ("Long at L-8 from L-11L-10") posPerLevel contract next bar at ep-8*levelDiff limit;
    buy ("Long at L-9 from L-11L-10") posPerLevel contract next bar at ep-9*levelDiff limit;
    buy ("Long at L-10 from L-11L-10") posPerLevel contract next bar at ep-10*levelDiff limit;
    buy ("Long at L-11 from L-11L-10") posPerLevel contract next bar at ep-11*levelDiff limit;
end;
